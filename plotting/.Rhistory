p.Cutoff <- 0.05
evc.david.filt <- EvC.DAVID %>% filter(PValue <= p.Cutoff)
evc.david.filt  <- tibble::rownames_to_column(evc.david.filt ,"Name")
evc.david.nohit <- evc.david.filt  %>% filter(Hit == "Other")
evc.david.hit <- evc.david.filt  %>% filter(Hit == "Hit")
ec.david.plot <- ggplot() + geom_jitter(data=evc.david.nohit, aes(x="Collection",y=PValue), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=evc.david.hit, aes(x="Collection",y=PValue), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("EvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.david.filt  <- G1vRev.DAVID %>% filter(PValue <= p.Cutoff)
g1vrev.david.filt  <- tibble::rownames_to_column(g1vrev.david.filt ,"Name")
g1rev.david.nohit <- g1vrev.david.filt  %>% filter(Hit == "Other")
g1rev.david.hit <- g1vrev.david.filt  %>% filter(Hit == "Hit")
g1rev.david.plot <- ggplot() + geom_jitter(data=g1rev.david.nohit, aes(x="Collection",y=PValue), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=g1rev.david.hit, aes(x="Collection",y=PValue), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("g1rev") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
hpm3AvC.david.filt  <- hpm3AvC.DAVID %>% filter(PValue <= p.Cutoff)
hpm3AvC.david.filt  <- tibble::rownames_to_column(hpm3AvC.david.filt ,"Name")
ac.david.nohit <- hpm3AvC.david.filt  %>% filter(Hit == "Other")
ac.david.hit <- hpm3AvC.david.filt  %>% filter(Hit == "Hit")
ac.david.plot <- ggplot() + geom_jitter(data=ac.david.nohit, aes(x="Collection",y=PValue), color="black", alpha=0.5, size=0.6, width=0.1) + geom_jitter(data=ac.david.hit, aes(x="Collection",y=PValue), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("hpm3.AvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
MuscleSvC.david.filt  <- MuscleSvC.DAVID %>% filter(PValue <= p.Cutoff)
MuscleSvC.david.filt  <- tibble::rownames_to_column(MuscleSvC.david.filt ,"Name")
sc.david.nohit <- MuscleSvC.david.filt  %>% filter(Hit == "Other")
sc.david.hit <- MuscleSvC.david.filt  %>% filter(Hit == "Hit")
sc.david.plot <- ggplot() + geom_jitter(data=sc.david.nohit, aes(x="Collection",y=PValue), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=sc.david.hit, aes(x="Collection",y=PValue), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("MuscleSvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
ggarrange(g1rev.david.plot,ec.david.plot,ac.david.plot,sc.david.plot, legend = FALSE, ncol=4, nrow=1)
EvC.gprofiler <- read.xlsx("../g_profiler/evc.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.gprofiler <- read.xlsx("../g_profiler/g1vrev.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
hpm3AvC.gprofiler <- read.xlsx("../g_profiler/hpm3avc.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
MuscleSvC.gprofiler <- read.xlsx("../g_profiler/muscsvc.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
p.Cutoff <- 0.05
evc.gpro.filt  <- EvC.gprofiler %>% filter(p_value <= p.Cutoff)
evc.gpro.filt <- tibble::rownames_to_column(evc.gpro.filt,"Name")
evc.gpro.nohit <- evc.gpro.filt %>% filter(Hit == "Other")
evc.gpro.hit <- evc.gpro.filt %>% filter(Hit == "Hit")
ec.gpro.plot <- ggplot() + geom_jitter(data=evc.gpro.nohit, aes(x="Collection",y=p_value), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=evc.gpro.hit, aes(x="Collection",y=p_value), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("EvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.gpro.filt <- G1vRev.gprofiler %>% filter(p_value <= p.Cutoff)
g1vrev.gpro.filt <- tibble::rownames_to_column(g1vrev.gpro.filt,"Name")
g1rev.gpro.nohit <- g1vrev.gpro.filt %>% filter(Hit == "Other")
g1rev.gpro.hit <- g1vrev.gpro.filt %>% filter(Hit == "Hit")
g1rev.gpro.plot <- ggplot() + geom_jitter(data=g1rev.gpro.nohit, aes(x="Collection",y=p_value), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=g1rev.gpro.hit, aes(x="Collection",y=p_value), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("g1rev") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
hpm3AvC.gpro.filt <- hpm3AvC.gprofiler %>% filter(p_value <= p.Cutoff)
hpm3AvC.gpro.filt <- tibble::rownames_to_column(hpm3AvC.gpro.filt,"Name")
ac.gpro.nohit <- hpm3AvC.gpro.filt %>% filter(Hit == "Other")
ac.gpro.hit <- hpm3AvC.gpro.filt %>% filter(Hit == "Hit")
ac.gpro.plot <- ggplot() + geom_jitter(data=ac.gpro.nohit, aes(x="Collection",y=p_value), color="black", alpha=0.5, size=0.6, width=0.1) + geom_jitter(data=ac.gpro.hit, aes(x="Collection",y=p_value), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("hpm3.AvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
MuscleSvC.gpro.filt <- MuscleSvC.gprofiler %>% filter(p_value <= p.Cutoff)
MuscleSvC.gpro.filt <- tibble::rownames_to_column(MuscleSvC.gpro.filt,"Name")
sc.gpro.nohit <- MuscleSvC.gpro.filt %>% filter(Hit == "Other")
sc.gpro.hit <- MuscleSvC.gpro.filt %>% filter(Hit == "Hit")
sc.gpro.plot <- ggplot() + geom_jitter(data=sc.gpro.nohit, aes(x="Collection",y=p_value), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=sc.gpro.hit, aes(x="Collection",y=p_value), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("MuscleSvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
ggarrange(g1rev.gpro.plot,ec.gpro.plot,ac.gpro.plot,sc.gpro.plot, legend = FALSE, ncol=4, nrow=1)
EvC.metacore <- read.xlsx("../shared_data/EvC_metacore_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.metacore <- read.xlsx("../shared_data/G1vRev_metacore_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
hpm3AvC.metacore <- read.xlsx("../shared_data/hpm3_AvC_metacore_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
MuscleSvC.metacore <- read.xlsx("../shared_data/Muscle_SkeletalvsCardiac_metacore_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
p.Cutoff <- 0.05
evc.mcore.filt <- EvC.metacore %>% filter(FDR <= p.Cutoff)
evc.mcore.filt <- tibble::rownames_to_column(evc.mcore.filt,"Name")
evc.mcore.nohit <- evc.mcore.filt %>% filter(Hit == "Other")
evc.mcore.hit <- evc.mcore.filt %>% filter(Hit == "Hit")
ec.mcore.plot <- ggplot() + geom_jitter(data=evc.mcore.nohit, aes(x="Collection",y=FDR), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=evc.mcore.hit, aes(x="Collection",y=FDR), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("EvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.mcore.filt <- G1vRev.metacore %>% filter(FDR <= p.Cutoff)
g1vrev.mcore.filt <- tibble::rownames_to_column(g1vrev.mcore.filt,"Name")
g1rev.mcore.nohit <- g1vrev.mcore.filt %>% filter(Hit == "Other")
g1rev.mcore.hit <- g1vrev.mcore.filt %>% filter(Hit == "Hit")
g1rev.mcore.plot <- ggplot() + geom_jitter(data=g1rev.mcore.nohit, aes(x="Collection",y=FDR), color="black", alpha=0.4, size=0.6, width=0.1) + theme_void() + ggtitle("g1rev") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
#no significant g1rev hits for metacore so this line was extracted
#geom_jitter(data=g1rev.mcore.hit, aes(x="Collection",y=FDR), color="red", alpha=1, size=2, width=0.1)
hpm3AvC.mcore.filt <- hpm3AvC.metacore %>% filter(FDR <= p.Cutoff)
hpm3AvC.mcore.filt <- tibble::rownames_to_column(hpm3AvC.mcore.filt,"Name")
ac.mcore.nohit <- hpm3AvC.mcore.filt %>% filter(Hit == "Other")
ac.mcore.hit <- hpm3AvC.mcore.filt %>% filter(Hit == "Hit")
ac.mcore.plot <- ggplot() + geom_jitter(data=ac.mcore.nohit, aes(x="Collection",y=FDR), color="black", alpha=0.5, size=0.6, width=0.1) + geom_jitter(data=ac.mcore.hit, aes(x="Collection",y=FDR), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("hpm3.AvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
MuscleSvC.mcore.filt <- MuscleSvC.metacore %>% filter(FDR <= p.Cutoff)
MuscleSvC.mcore.filt <- tibble::rownames_to_column(MuscleSvC.mcore.filt,"Name")
sc.mcore.nohit <- MuscleSvC.mcore.filt %>% filter(Hit == "Other")
sc.mcore.hit <- MuscleSvC.mcore.filt %>% filter(Hit == "Hit")
sc.mcore.plot <- ggplot() + geom_jitter(data=sc.mcore.nohit, aes(x="Collection",y=FDR), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=sc.mcore.hit, aes(x="Collection",y=FDR), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("MuscleSvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
ggarrange(g1rev.mcore.plot,ec.mcore.plot,ac.mcore.plot,sc.mcore.plot, legend = FALSE, ncol=4, nrow=1)
EvC.ipa <- read.xlsx("../shared_data/EvC_ipa_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.ipa <- read.xlsx("../shared_data/G1vRev_ipa_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
hpm3AvC.ipa <- read.xlsx("../shared_data/hpm3_AvC_ipa_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
MuscleSvC.ipa <- read.xlsx("../shared_data/Muscle_SkeletalvsCardiac_ipa_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
p.Cutoff <- 0.05
evc.ipa.filt <- EvC.ipa %>% filter(p_value <= p.Cutoff)
evc.ipa.filt <- tibble::rownames_to_column(evc.ipa.filt,"Name")
evc.ipa.nohit <- evc.ipa.filt %>% filter(Hit == "Other")
evc.ipa.hit <- evc.ipa.filt %>% filter(Hit == "Hit")
ec.ipa.plot <- ggplot() + geom_jitter(data=evc.ipa.nohit, aes(x="Collection",y=p_value), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=evc.ipa.hit, aes(x="Collection",y=p_value), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("EvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.ipa.filt <- G1vRev.ipa %>% filter(p_value <= p.Cutoff)
g1vrev.ipa.filt <- tibble::rownames_to_column(g1vrev.ipa.filt,"Name")
g1rev.ipa.nohit <- g1vrev.ipa.filt %>% filter(Hit == "Other")
g1rev.ipa.hit <- g1vrev.ipa.filt %>% filter(Hit == "Hit")
g1rev.ipa.plot <- ggplot() + geom_jitter(data=g1rev.ipa.nohit, aes(x="Collection",y=p_value), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=g1rev.ipa.hit, aes(x="Collection",y=p_value), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("g1rev") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
hpm3AvC.ipa.filt <- hpm3AvC.ipa %>% filter(p_value <= p.Cutoff)
hpm3AvC.ipa.filt <- tibble::rownames_to_column(hpm3AvC.ipa.filt,"Name")
ac.ipa.nohit <- hpm3AvC.ipa.filt %>% filter(Hit == "Other")
ac.ipa.hit <- hpm3AvC.ipa.filt %>% filter(Hit == "Hit")
ac.ipa.plot <- ggplot() + geom_jitter(data=ac.ipa.nohit, aes(x="Collection",y=p_value), color="black", alpha=0.5, size=0.6, width=0.1) + geom_jitter(data=ac.ipa.hit, aes(x="Collection",y=p_value), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("hpm3.AvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
MuscleSvC.ipa.filt <- MuscleSvC.ipa %>% filter(p_value <= p.Cutoff)
MuscleSvC.ipa.filt <- tibble::rownames_to_column(MuscleSvC.ipa.filt,"Name")
sc.ipa.nohit <- MuscleSvC.ipa.filt %>% filter(Hit == "Other")
sc.ipa.hit <- MuscleSvC.ipa.filt %>% filter(Hit == "Hit")
sc.ipa.plot <- ggplot() + geom_jitter(data=sc.ipa.nohit, aes(x="Collection",y=p_value), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=sc.ipa.hit, aes(x="Collection",y=p_value), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("MuscleSvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
ggarrange(g1rev.ipa.plot,ec.ipa.plot,ac.ipa.plot,sc.ipa.plot, legend = FALSE, ncol=4, nrow=1)
EvC.ipath <- read.xlsx("../shared_data/EvC_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.ipath <- read.xlsx("../shared_data/G1vRev_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
hpm3AvC.ipath <- read.xlsx("../shared_data/hpm3_AvC_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
MuscleSvC.ipath <- read.xlsx("../shared_data/Muscle_SkeletalvsCardiac_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
p.Cutoff <- 0.05
evc.ipath.filt <- EvC.ipath %>% filter(pv_fdr <= p.Cutoff)
evc.ipath.filt <- tibble::rownames_to_column(evc.ipath.filt,"UniqName")
evc.ipath.nohit <- evc.ipath.filt %>% filter(Hit == "Other")
evc.ipath.hit <- evc.ipath.filt %>% filter(Hit == "Hit")
ec.ipath.plot <- ggplot() + geom_jitter(data=evc.ipath.nohit, aes(x="Collection",y=pv_fdr), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=evc.ipath.hit, aes(x="Collection",y=pv_fdr), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("EvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.ipath.filt <- G1vRev.ipath %>% filter(pv_fdr <= p.Cutoff)
g1vrev.ipath.filt <- tibble::rownames_to_column(g1vrev.ipath.filt,"UniqName")
g1rev.ipath.nohit <- g1vrev.ipath.filt %>% filter(Hit == "Other")
g1rev.ipath.hit <- g1vrev.ipath.filt %>% filter(Hit == "Hit")
g1rev.ipath.plot <- ggplot() + geom_jitter(data=g1rev.ipath.nohit, aes(x="Collection",y=pv_fdr), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=g1rev.ipath.hit, aes(x="Collection",y=pv_fdr), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("g1rev") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
hpm3AvC.ipath.filt <- hpm3AvC.ipath %>% filter(pv_fdr <= p.Cutoff)
hpm3AvC.ipath.filt <- tibble::rownames_to_column(hpm3AvC.ipath.filt,"UniqName")
ac.ipath.nohit <- hpm3AvC.ipath.filt %>% filter(Hit == "Other")
ac.ipath.hit <- hpm3AvC.ipath.filt %>% filter(Hit == "Hit")
ac.ipath.plot <- ggplot() + geom_jitter(data=ac.ipath.nohit, aes(x="Collection",y=pv_fdr), color="black", alpha=0.5, size=0.6, width=0.1) + geom_jitter(data=ac.ipath.hit, aes(x="Collection",y=pv_fdr), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("hpm3.AvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
MuscleSvC.ipath.filt <- MuscleSvC.ipath %>% filter(pv_fdr <= p.Cutoff)
MuscleSvC.ipath.filt <- tibble::rownames_to_column(MuscleSvC.ipath.filt,"UniqName")
sc.ipath.nohit <- MuscleSvC.ipath.filt %>% filter(Hit == "Other")
sc.ipath.hit <- MuscleSvC.ipath.filt %>% filter(Hit == "Hit")
sc.ipath.plot <- ggplot() + geom_jitter(data=sc.ipath.nohit, aes(x="Collection",y=pv_fdr), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=sc.ipath.hit, aes(x="Collection",y=pv_fdr), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("MuscleSvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
ggarrange(g1rev.ipath.plot,ec.ipath.plot,ac.ipath.plot,sc.ipath.plot, legend = FALSE, ncol=4, nrow=1)
ggplot() +
geom_jitter(data=sc.ipath.nohit, aes(x="Collection",y=pv_fdr), color="black", alpha=0.4, size=0.6, width=0.1) +
geom_jitter(data=sc.ipath.hit, aes(x="Collection",y=pv_fdr), color="red", alpha=1, size=2, width=0.1) + theme_void() +
ggtitle("MuscleSvC") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = unit(c(-1,0,-1,0),"cm"),complete=FALSE ##top, right, bottom, left
) + coord_flip()
EvC.gsea.select <- EvC.GSEA  %>% filter(Collection %in% c("h","c2cgp","c2cp","c5bp", "c5mf", "c5cc"))
EvC.gsea.select <- tibble::rownames_to_column(EvC.gsea.select,"Term")
EvC.gsea.select.nohit <- EvC.gsea.select %>% filter(Hit == "Other")
EvC.gsea.select.hit <- EvC.gsea.select %>% filter(Hit == "Hit")
ggplot() + geom_jitter(data=EvC.gsea.select.nohit, aes(x=Collection,y=FDR), color="black", alpha=0.3, size=0.6, width=0.1) + geom_jitter(data=EvC.gsea.select.hit, aes(x=Collection,y=FDR), color="red", alpha=1, size=2, width=0.1) + theme_bw() + coord_flip()
G1vRev.RevDEGS.gprofiler <- read.xlsx("../g_profiler/g1vrev.RevDegs.gprofilerPlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
alp.val <- 1
pt.size <- 2
G1vRev.RevDEGS.gprofiler.nohit <- G1vRev.RevDEGS.gprofiler %>% filter(E2F.Hit == "Other")
G1vRev.RevDEGS.gprofiler.low <- G1vRev.RevDEGS.gprofiler %>% filter(E2F.Hit == "Low")
G1vRev.RevDEGS.gprofiler.hit <- G1vRev.RevDEGS.gprofiler %>% filter(E2F.Hit == "Hit")
ggplot() + geom_jitter(data=G1vRev.RevDEGS.gprofiler.nohit, aes(x=source,y=p_value), color="black", alpha=alp.val, size=pt.size, width=0.1) + geom_jitter(data=G1vRev.RevDEGS.gprofiler.low, aes(x=source,y=p_value), color="blue", alpha=alp.val, size=pt.size, width=0.1) + geom_jitter(data=G1vRev.RevDEGS.gprofiler.hit, aes(x=source,y=p_value), color="red", alpha=alp.val, size=pt.size+1, width=0.1) + theme_bw() + coord_flip()
evc.KEGG <- read.xlsx("../shared_data/EvC_KEGG_Summary.xlsx", colNames=TRUE, rowNames=TRUE)
evc.KEGG.ppar <- evc.KEGG %>% filter(Group == "PPAR")
evc.KEGG.other <- evc.KEGG %>% filter(Group == "Other")
ggplot() + geom_jitter(data=evc.KEGG.other, aes(x=Method,y=pval), color="black", alpha=0.5, size=2, width=0.1) + geom_jitter(data=evc.KEGG.ppar, aes(x=Method,y=pval), color="red", alpha=1, size=4, width=0.1) + theme_bw() + coord_flip()
evc.KEGG <- read.xlsx("../shared_data/EvC_KEGG_Summary.xlsx", colNames=TRUE, rowNames=TRUE)
evc.KEGG <- evc.KEGG %>% mutate(neglogP = -log10(pval))
evc.KEGG.ppar <- evc.KEGG %>% filter(Group == "PPAR")
evc.KEGG.other <- evc.KEGG %>% filter(Group == "Other")
ppar.pub <- ggplot() + geom_jitter(data=evc.KEGG.other, aes(x=Method,y=neglogP), color="black", alpha=0.5, size=2, width=0.2) + geom_jitter(data=evc.KEGG.ppar, aes(x=Method,y=neglogP), color="red", alpha=1, size=4, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
ppar.pub
pdf('ppar.pub.pdf')
ppar.pub
dev.off()
p.Cutoff <- 1
G1vRev.DAVID <- read.xlsx("../DAVID/g1vRev.DEGS.1.DAVID_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.DAVID.FC.58 <- read.xlsx("../DAVID/g1vRev.DEGS.58.DAVID_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.DAVID.RevDEGS <- read.xlsx("../DAVID/g1vRev.revDEGS.1.DAVID_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.DAVID.RevDEGS.58 <- read.xlsx("../DAVID/g1vRev.revDEGS.58.DAVID_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
g1vrev.david.filt  <- G1vRev.DAVID %>% filter(Bonferroni <= p.Cutoff)
g1vrev.david.filt  <- tibble::rownames_to_column(g1vrev.david.filt ,"Name")
g1rev.david.nohit <- g1vrev.david.filt  %>% filter(Hit == "Other")
g1rev.david.hit <- g1vrev.david.filt  %>% filter(Hit == "Hit")
g1rev.david.plot <- ggplot() + geom_jitter(data=g1rev.david.nohit, aes(x=Category,y=Bonferroni), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=g1rev.david.hit, aes(x=Category,y=Bonferroni), color="red", alpha=1, size=2, width=0.1) + ggtitle("g1rev") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.david.fc.58.filt  <- G1vRev.DAVID.FC.58 %>% filter(Bonferroni <= p.Cutoff)
g1vrev.david.fc.58.filt  <- tibble::rownames_to_column(g1vrev.david.fc.58.filt ,"Name")
g1rev.david.fc.58.nohit <- g1vrev.david.fc.58.filt  %>% filter(Hit == "Other")
g1rev.david.fc.58.hit <- g1vrev.david.fc.58.filt  %>% filter(Hit == "Hit")
g1rev.david.fc.58.plot <- ggplot() + geom_jitter(data=g1rev.david.fc.58.nohit, aes(x=Category,y=Bonferroni), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=g1rev.david.fc.58.hit, aes(x=Category,y=Bonferroni), color="red", alpha=1, size=2, width=0.1)  + ggtitle("g1rev.fc.58") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.david.revdegs.filt  <- G1vRev.DAVID.RevDEGS %>% filter(Bonferroni <= p.Cutoff)
g1vrev.david.revdegs.filt  <- tibble::rownames_to_column(g1vrev.david.revdegs.filt ,"Name")
g1rev.david.revdegs.nohit <- g1vrev.david.revdegs.filt  %>% filter(Hit == "Other")
g1rev.david.revdegs.hit <- g1vrev.david.revdegs.filt  %>% filter(Hit == "Hit")
g1rev.david.revdegs.plot <- ggplot() + geom_jitter(data=g1rev.david.revdegs.nohit, aes(x=Category,y=Bonferroni), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=g1rev.david.revdegs.hit, aes(x=Category,y=Bonferroni), color="red", alpha=1, size=2, width=0.1) + ggtitle("g1rev.revdegs") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.david.revdegs.58.filt  <- G1vRev.DAVID.RevDEGS.58 %>% filter(Bonferroni <= p.Cutoff)
g1vrev.david.revdegs.58.filt  <- tibble::rownames_to_column(g1vrev.david.revdegs.58.filt ,"Name")
g1rev.david.revdegs.58.nohit <- g1vrev.david.revdegs.58.filt  %>% filter(Hit == "Other")
g1rev.david.revdegs.58.hit <- g1vrev.david.revdegs.58.filt  %>% filter(Hit == "Hit")
g1rev.david.revdegs.58.plot <- ggplot() + geom_jitter(data=g1rev.david.revdegs.58.nohit, aes(x=Category,y=Bonferroni), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=g1rev.david.revdegs.58.hit, aes(x=Category,y=Bonferroni), color="red", alpha=1, size=2, width=0.1) + ggtitle("g1rev.revdegs.58") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
ggarrange(g1rev.david.plot,g1rev.david.fc.58.plot,g1rev.david.revdegs.plot,g1rev.david.revdegs.58.plot, legend = FALSE, ncol=2, nrow=2)
p.Cutoff <- 0.1
G1vRev.gpro <- read.xlsx("../g_profiler/g1vrev.Degs.1.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.gpro.FC.58 <- read.xlsx("../g_profiler/g1vrev.Degs.58.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.gpro.RevDEGS <- read.xlsx("../g_profiler/g1vrev.revDegs.1.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.gpro.RevDEGS.58 <- read.xlsx("../g_profiler/g1vrev.revDegs.58.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
g1vrev.gpro.filt  <- G1vRev.gpro %>% filter(p_value <= p.Cutoff)
g1vrev.gpro.filt  <- tibble::rownames_to_column(g1vrev.gpro.filt ,"Name")
g1rev.gpro.nohit <- g1vrev.gpro.filt  %>% filter(Hit == "Other")
g1rev.gpro.hit <- g1vrev.gpro.filt  %>% filter(Hit == "Hit")
g1rev.gpro.plot <- ggplot() + geom_jitter(data=g1rev.gpro.nohit, aes(x=source,y=p_value), color="black", alpha=0.4, size=1, width=0.2) + geom_jitter(data=g1rev.gpro.hit, aes(x=source,y=p_value), color="red", alpha=1, size=2, width=0.2) + ggtitle("g1rev") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.gpro.fc.58.filt  <- G1vRev.gpro.FC.58 %>% filter(p_value <= p.Cutoff)
g1vrev.gpro.fc.58.filt  <- tibble::rownames_to_column(g1vrev.gpro.fc.58.filt ,"Name")
g1rev.gpro.fc.58.nohit <- g1vrev.gpro.fc.58.filt  %>% filter(Hit == "Other")
g1rev.gpro.fc.58.hit <- g1vrev.gpro.fc.58.filt  %>% filter(Hit == "Hit")
g1rev.gpro.fc.58.plot <- ggplot() + geom_jitter(data=g1rev.gpro.fc.58.nohit, aes(x=source,y=p_value), color="black", alpha=0.4, size=1, width=0.2) + geom_jitter(data=g1rev.gpro.fc.58.hit, aes(x=source,y=p_value), color="red", alpha=1, size=2, width=0.2) + ggtitle("g1rev.fc.58") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.gpro.revdegs.filt  <- G1vRev.gpro.RevDEGS %>% filter(p_value <= p.Cutoff)
g1vrev.gpro.revdegs.filt  <- tibble::rownames_to_column(g1vrev.gpro.revdegs.filt ,"Name")
g1rev.gpro.revdegs.nohit <- g1vrev.gpro.revdegs.filt  %>% filter(Hit == "Other")
g1rev.gpro.revdegs.hit <- g1vrev.gpro.revdegs.filt  %>% filter(Hit == "Hit")
g1rev.gpro.revdegs.plot <- ggplot() + geom_jitter(data=g1rev.gpro.revdegs.nohit, aes(x=source,y=p_value), color="black", alpha=0.4, size=1, width=0.2) + geom_jitter(data=g1rev.gpro.revdegs.hit, aes(x=source,y=p_value), color="red", alpha=1, size=2, width=0.2) + ggtitle("g1rev.revdegs") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.gpro.revdegs.58.filt  <- G1vRev.gpro.RevDEGS.58 %>% filter(p_value <= p.Cutoff)
g1vrev.gpro.revdegs.58.filt  <- tibble::rownames_to_column(g1vrev.gpro.revdegs.58.filt ,"Name")
g1rev.gpro.revdegs.58.nohit <- g1vrev.gpro.revdegs.58.filt  %>% filter(Hit == "Other")
g1rev.gpro.revdegs.58.hit <- g1vrev.gpro.revdegs.58.filt  %>% filter(Hit == "Hit")
g1rev.gpro.revdegs.58.plot <- ggplot() + geom_jitter(data=g1rev.gpro.revdegs.58.nohit, aes(x=source,y=p_value), color="black", alpha=0.4, size=1, width=0.2) + geom_jitter(data=g1rev.gpro.revdegs.58.hit, aes(x=source,y=p_value), color="red", alpha=1, size=2, width=0.2) + ggtitle("g1rev.revdegs.58") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
ggarrange(g1rev.gpro.plot,g1rev.gpro.fc.58.plot,g1rev.gpro.revdegs.plot,g1rev.gpro.revdegs.58.plot, legend = FALSE, ncol=2, nrow=2)
msig7.2 <- read.xlsx("../shared_data/msigdb_genesetsInfo_v7.2_paperSubset.xlsx", colNames=TRUE, rowNames=TRUE)
sub300 <- msig7.2 %>% filter(Size <= 300)
plus300 <- msig7.2 %>% filter(Size > 300)
boxplot7.2 <- ggplot(msig7.2, aes(Group, Size)) + geom_boxplot() + coord_cartesian(ylim = c(0, 300)) +
scale_x_discrete(limits = c("HALLMARK", "c2cgp", "c2cp", "KEGG", "BIOCARTA", "PID", "REACTOME", "WP", "c5bp", "c5cc", "c5mf"))
boxplot7.2
pdf('boxplot7.2.pdf',width=10, height=10)
boxplot7.2
dev.off()
table(plus300$Group)
table(sub300$Group)
table(msig7.2$Group)
as.data.frame(msig7.2 %>% group_by(Group) %>% summarize(n(),median(Size), mean(Size)))
length(msig7.2$Size)
mean(msig7.2$Size)
source("replotGSEA.R")
replotGSEA("C:/Users/Charlie/ABRF_GBIRG_OntologyStudy/dataset_gsea/dataset_runs/avc_TNF.GseaPreranked.1613569188946",
gene.set ="HALLMARK_TNFA_SIGNALING_VIA_NFKB", "A", metric.range = c(-50,50), enrichment.score.range = c(-1,1))
replotGSEA("C:/Users/Charlie/ABRF_GBIRG_OntologyStudy/dataset_gsea/dataset_runs/evc_KEGG_PPAR.GseaPreranked.1613569183925",
gene.set ="KEGG_PPAR_SIGNALING_PATHWAY", "A", metric.range = c(-50,50), enrichment.score.range = c(-1,1))
replotGSEA("C:/Users/Charlie/ABRF_GBIRG_OntologyStudy/dataset_gsea/dataset_runs/g1vrev_E2F.GseaPreranked.1613569193955",
gene.set ="HALLMARK_E2F_TARGETS", "A", metric.range = c(-50,50), enrichment.score.range = c(-1,1))
replotGSEA("C:/Users/Charlie/ABRF_GBIRG_OntologyStudy/dataset_gsea/dataset_runs/svc_SKEMUSC.GseaPreranked.1613569198989",
gene.set ="GO_SKELETAL_MUSCLE_CONTRACTION", "A", metric.range = c(-50,50), enrichment.score.range = c(-1,1))
avc.path <- read.xlsx("../shared_data/IL17_pathways_summaryFigure.xlsx", colNames=TRUE, rowNames=TRUE)
avc.path <- avc.path %>% mutate(neglogP = -log10(pval))
avc.path.il17best <- avc.path %>% filter(Group == "IL17best")
avc.path.il17 <- avc.path %>% filter(Group == "IL17")
avc.path.other <- avc.path %>% filter(Group == "Other")
avc.IL17.pub <- ggplot() + geom_jitter(data=avc.path.other, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="darkgrey", alpha=0.2, size=1, width=0.2) + geom_jitter(data=avc.path.il17, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA', 'DAVID')),y=neglogP), color="blue", alpha=0.6, size=3, width=0.2) + geom_jitter(data=avc.path.il17best, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="red", alpha=1, size=4, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
avc.IL17.pub
pdf('avc.IL17.pdf')
avc.IL17.pub
dev.off()
svc.gpBP <- read.xlsx("../shared_data/musc_GOBP_tests.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
svc.gpBP <- svc.gpBP %>% mutate(neglogP = -log10(p_value))
svc.gpBP.best <- svc.gpBP %>% filter(Hit == "Best")
svc.gpBP.hit <- svc.gpBP %>% filter(Hit == "Hit")
svc.gpBP.other <- svc.gpBP %>% filter(Hit == "Other")
svc.pub <- ggplot() + geom_jitter(data=svc.gpBP.other, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="darkgrey", alpha=0.1, size=1, width=0.2) + geom_jitter(data=svc.gpBP.hit, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="blue", alpha=0.6, size=2, width=0.2) + geom_jitter(data=svc.gpBP.best, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="red", alpha=1, size=3, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
svc.pub
pdf('svc.pdf')
svc.pub
dev.off()
svc.gpBP <- read.xlsx("../shared_data/musc_GOBP_tests.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
svc.gpBP <- svc.gpBP %>% mutate(neglogP = -log10(p_value))
svc.gpBP.best <- svc.gpBP %>% filter(Hit == "Best")
svc.gpBP.hit <- svc.gpBP %>% filter(Hit == "Hit")
svc.gpBP.other <- svc.gpBP %>% filter(Hit == "Other")
svc.pub <- ggplot() + geom_jitter(data=svc.gpBP.other, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="darkgrey", alpha=0.1, size=1, width=0.2) + geom_jitter(data=svc.gpBP.hit, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="blue", alpha=0.6, size=2, width=0.2) + geom_jitter(data=svc.gpBP.best, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="red", alpha=1, size=3, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
svc.pub
pdf('svc.pdf')
svc.pub
dev.off()
knitr::opts_chunk$set(echo = TRUE)
library(openxlsx)
library(ggplot2)
library(tidyverse)
library(ggpubr)
library(stringr)
library(pastecs)
evcPCA <- read.xlsx("evc_pca.xlsx", colNames=TRUE, rowNames=TRUE)
g1revPCA <- read.xlsx("G1vRev_pca.xlsx", colNames=TRUE, rowNames=TRUE)
avcPCA <- read.xlsx("avc_pca.xlsx", colNames=TRUE, rowNames=TRUE)
svcPCA <- read.xlsx("muscle_pca.xlsx", colNames=TRUE, rowNames=TRUE)
evc.PCAplot <- ggplot(evcPCA,aes(x=PC1,y=PC2, col=as.factor(group)))+
geom_point(size=5)+
theme_bw()+ggtitle('EvC PCA') + theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.25), hjust = 0.5),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
g1rev.PCAplot <- ggplot(g1revPCA,aes(x=PC1,y=PC2, col=as.factor(group)))+
geom_point(size=5)+
theme_bw()+ggtitle('G1vRev PCA')+ theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.25), hjust = 0.5),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
avc.PCAplot <- ggplot(avcPCA,aes(x=PC1,y=PC2, col=as.factor(group)))+
geom_point(size=5)+
theme_bw()+ggtitle('hpm3AvC PCA')+ theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.25), hjust = 0.5),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
svc.PCAplot <- ggplot(svcPCA,aes(x=PC1,y=PC2, col=as.factor(group)))+
geom_point(size=5)+
theme_bw()+ggtitle('SvC PCA') + theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.25), hjust = 0.5),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
evcDE <- read.xlsx("../shared_data/EvC_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
evcDE <- evcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"DEGS (1068)","Other (17815)"))
g1revDE <- read.xlsx("../shared_data/G1vRev_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
g1revDE <- g1revDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"DEGS (102)","Other (20135)"))
avcDE <- read.xlsx("../shared_data/hpm3_AvC_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
avcDE <- avcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"DEGS (1289)","Other (15218)"))
svcDE <- read.xlsx("../shared_data/musc_SkeVHeart_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
svcDE <- svcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"DEGS (6369)","Other (12368)"))
evc.Volcanoplot <- ggplot(evcDE) +
geom_point(size=3,aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("EvC Volcano") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme_bw() + theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
g1rev.Volcanoplot <- ggplot(g1revDE) +
geom_point(size=3,aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("G1vRev Volcano") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme_bw() + theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
avc.Volcanoplot <- ggplot(avcDE) +
geom_point(size=3,aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("hpm3AvC Volcano") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme_bw() + theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
svc.Volcanoplot <- ggplot(svcDE) +
geom_point(size=3,aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("SvC Volcano") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme_bw() + theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
table(evcDE$threshold)
table(g1revDE$threshold)
table(avcDE$threshold)
table(svcDE$threshold)
evcPub <- ggarrange(evc.PCAplot,evc.Volcanoplot, ncol=1, nrow=2)
pdf('evcPub.pdf',width=10, height=10)
evcPub
dev.off()
evcPub
ggarrange(g1rev.PCAplot,g1rev.Volcanoplot, ncol=1, nrow=2)
ggarrange(avc.PCAplot,avc.Volcanoplot, ncol=1, nrow=2)
ggarrange(svc.PCAplot,svc.Volcanoplot, ncol=1, nrow=2)
evcPub <- ggarrange(evc.PCAplot,evc.Volcanoplot, ncol=1, nrow=2)
pdf('evcPub.pdf',width=10, height=10)
evcPub
dev.off()
evcPub
ggarrange(g1rev.PCAplot,g1rev.Volcanoplot, ncol=1, nrow=2)
ggarrange(avc.PCAplot,avc.Volcanoplot, ncol=1, nrow=2)
ggarrange(svc.PCAplot,svc.Volcanoplot, ncol=1, nrow=2)
evcPub <- ggarrange(evc.PCAplot,evc.Volcanoplot, ncol=1, nrow=2)
pdf('evcPub.pdf',width=12, height=8)
evcPub
dev.off()
evcPub
ggarrange(g1rev.PCAplot,g1rev.Volcanoplot, ncol=1, nrow=2)
ggarrange(avc.PCAplot,avc.Volcanoplot, ncol=1, nrow=2)
ggarrange(svc.PCAplot,svc.Volcanoplot, ncol=1, nrow=2)
evcPub <- ggarrange(evc.PCAplot,evc.Volcanoplot, ncol=1, nrow=2)
pdf('evcPub.pdf',width=6, height=12)
evcPub
dev.off()
evcPub
ggarrange(g1rev.PCAplot,g1rev.Volcanoplot, ncol=1, nrow=2)
ggarrange(avc.PCAplot,avc.Volcanoplot, ncol=1, nrow=2)
ggarrange(svc.PCAplot,svc.Volcanoplot, ncol=1, nrow=2)
evcPub <- ggarrange(evc.PCAplot,evc.Volcanoplot, ncol=1, nrow=2)
pdf('evcPub.pdf',width=9, height=12)
evcPub
dev.off()
evcPub
ggarrange(g1rev.PCAplot,g1rev.Volcanoplot, ncol=1, nrow=2)
ggarrange(avc.PCAplot,avc.Volcanoplot, ncol=1, nrow=2)
ggarrange(svc.PCAplot,svc.Volcanoplot, ncol=1, nrow=2)
evcPub <- ggarrange(evc.PCAplot,evc.Volcanoplot, ncol=1, nrow=2)
pdf('evcPub.pdf',width=3, height=5)
evcPub
dev.off()
evcPub
ggarrange(g1rev.PCAplot,g1rev.Volcanoplot, ncol=1, nrow=2)
ggarrange(avc.PCAplot,avc.Volcanoplot, ncol=1, nrow=2)
ggarrange(svc.PCAplot,svc.Volcanoplot, ncol=1, nrow=2)
evcPub <- ggarrange(evc.PCAplot,evc.Volcanoplot, ncol=1, nrow=2)
pdf('evcPub.pdf',width=4, height=6)
evcPub
dev.off()
evcPub
ggarrange(g1rev.PCAplot,g1rev.Volcanoplot, ncol=1, nrow=2)
ggarrange(avc.PCAplot,avc.Volcanoplot, ncol=1, nrow=2)
ggarrange(svc.PCAplot,svc.Volcanoplot, ncol=1, nrow=2)
evcPub <- ggarrange(evc.PCAplot,evc.Volcanoplot, ncol=1, nrow=2)
pdf('evcPub.pdf',width=4, height=6)
evcPub
dev.off()
gvrPub <- ggarrange(g1rev.PCAplot,g1rev.Volcanoplot, ncol=1, nrow=2)
pdf('gvrPub.pdf',width=4, height=6)
gvrPub
dev.off()
avcPub <- ggarrange(avc.PCAplot,avc.Volcanoplot, ncol=1, nrow=2)
pdf('avcPub.pdf',width=4, height=6)
avcPub
dev.off()
svcPub <- ggarrange(svc.PCAplot,svc.Volcanoplot, ncol=1, nrow=2)
pdf('svcPub.pdf',width=4, height=6)
svcPub
dev.off()
evcPub
gvrPub
avcPub
svcPub
knitr::opts_chunk$set(echo = TRUE)
library(openxlsx)
library(tidyverse)
library(ggpubr)
library(stringr)
library(pastecs)
evcPCA <- read.xlsx("evc_pca.xlsx", colNames=TRUE, rowNames=TRUE)
g1revPCA <- read.xlsx("G1vRev_pca.xlsx", colNames=TRUE, rowNames=TRUE)
avcPCA <- read.xlsx("avc_pca.xlsx", colNames=TRUE, rowNames=TRUE)
svcPCA <- read.xlsx("muscle_pca.xlsx", colNames=TRUE, rowNames=TRUE)
evc.PCAplot <- ggplot(evcPCA,aes(x=PC1,y=PC2, col=as.factor(group)))+
geom_point(size=5)+
theme_bw()+ggtitle('EvC PCA') + theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.25), hjust = 0.5),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
g1rev.PCAplot <- ggplot(g1revPCA,aes(x=PC1,y=PC2, col=as.factor(group)))+
geom_point(size=5)+
theme_bw()+ggtitle('G1vRev PCA')+ theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.25), hjust = 0.5),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
avc.PCAplot <- ggplot(avcPCA,aes(x=PC1,y=PC2, col=as.factor(group)))+
geom_point(size=5)+
theme_bw()+ggtitle('hpm3AvC PCA')+ theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.25), hjust = 0.5),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
svc.PCAplot <- ggplot(svcPCA,aes(x=PC1,y=PC2, col=as.factor(group)))+
geom_point(size=5)+
theme_bw()+ggtitle('SvC PCA') + theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.25), hjust = 0.5),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
evcDE <- read.xlsx("../shared_data/EvC_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
evcDE <- evcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"DEGS (1068)","Other (17815)"))
g1revDE <- read.xlsx("../shared_data/G1vRev_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
g1revDE <- g1revDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"DEGS (102)","Other (20135)"))
avcDE <- read.xlsx("../shared_data/hpm3_AvC_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
avcDE <- avcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"DEGS (1289)","Other (15218)"))
svcDE <- read.xlsx("../shared_data/musc_SkeVHeart_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
svcDE <- svcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"DEGS (6369)","Other (12368)"))
evc.Volcanoplot <- ggplot(evcDE) +
geom_point(size=3,aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("EvC Volcano") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme_bw() + theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
g1rev.Volcanoplot <- ggplot(g1revDE) +
geom_point(size=3,aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("G1vRev Volcano") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme_bw() + theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
avc.Volcanoplot <- ggplot(avcDE) +
geom_point(size=3,aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("hpm3AvC Volcano") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme_bw() + theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
svc.Volcanoplot <- ggplot(svcDE) +
geom_point(size=3,aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("SvC Volcano") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme_bw() + theme(legend.title = element_blank(),plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),legend.position="bottom",legend.text = element_text(color="black", size=rel(1.3)))
table(evcDE$threshold)
table(g1revDE$threshold)
table(avcDE$threshold)
table(svcDE$threshold)
evcPub <- ggarrange(evc.PCAplot,evc.Volcanoplot, ncol=1, nrow=2)
pdf('evcPub.pdf',width=4, height=6)
evcPub
dev.off()
gvrPub <- ggarrange(g1rev.PCAplot,g1rev.Volcanoplot, ncol=1, nrow=2)
pdf('gvrPub.pdf',width=4, height=6)
gvrPub
dev.off()
avcPub <- ggarrange(avc.PCAplot,avc.Volcanoplot, ncol=1, nrow=2)
pdf('avcPub.pdf',width=4, height=6)
avcPub
dev.off()
svcPub <- ggarrange(svc.PCAplot,svc.Volcanoplot, ncol=1, nrow=2)
pdf('svcPub.pdf',width=4, height=6)
svcPub
dev.off()
evcPub
gvrPub
avcPub
svcPub
